<!DOCTYPE html>
<html>
  <head>
    <title>AR mic</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script> 
    <script src="https://unpkg.com/aframe-chromakey-material-fanter/dist/aframe-chromakey-material.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Fanter2033/ar_mic@main/public/style.css" />
    <script src="https://cdn.jsdelivr.net/gh/Fanter2033/ar_mic@main/public/js/marker-video-controller.js" defer></script>
    <script src="https://cdn.jsdelivr.net/gh/Fanter2033/ar_mic@main/public/js/ui-controls.js" defer></script>
    <script src="https://cdn.jsdelivr.net/gh/Fanter2033/ar_mic@main/public/js/main.js" defer></script>
  </head>

  <!--UI Buttons -->
  <button id="clean-fullscreen-btn">
    <svg id="fullscreen-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/>
    </svg>
  </button>
  <button id="change-len-btn">ENG</button>

  <body style="margin: 0; overflow: hidden">

    <!-- LOADING SPINNER -->
    <div id="loading-overlay">
      <div class="spinner"></div>
      <p>Caricamento…</p>
    </div>

    <!-- AR SCENE -->
    <a-scene
      vr-mode-ui="enabled: false"
      embedded
      renderer="alpha: true; antialias: true;"
      arjs="sourceType: webcam; debugUIEnabled: false;"
    >
      <!-- DRAGO -->
      <a-assets id="drago">
        <video
          id="drago-video-ita"
          src="https://cdn.jsdelivr.net/gh/Fanter2033/ar_mic@main/public/media/drago/drago_ITA.webm"
          loop
          playsinline
          preload="metadata"
          crossorigin="anonymous"
          webkit-playsinline
        >
        </video>
        <video
          id="drago-video-eng"
          src="https://cdn.jsdelivr.net/gh/Fanter2033/ar_mic@main/public/media/drago/drago_ENG.webm"
          loop
          playsinline
          preload="metadata"
          crossorigin="anonymous"
          webkit-playsinline
        ></video>
      </a-assets>
      <a-marker
        type="pattern"
        url="https://cdn.jsdelivr.net/gh/Fanter2033/ar_mic@main/public/media/drago/pattern-drago.patt"
        smooth="true"
        smoothCount="1"
        smoothTolerance="0.001"
      >
        <a-plane
          src="#drago-video-ita"
          width="4"
          height="4"
          position="0 0.01 0"
          rotation="-90 0 0"
          material="transparent: true;"
        ></a-plane>
      </a-marker>

      <!-- BODHISATTVA -->
      <a-assets id="bod">
        <video
          id="bod-video-ita"
          src="https://cdn.jsdelivr.net/gh/Fanter2033/ar_mic@main/public/media/bod/bod_ITA.webm"
          loop
          playsinline
          preload="none"
          crossorigin="anonymous"
          webkit-playsinline
        ></video>
        <video
          id="bod-video-eng"
          src="https://cdn.jsdelivr.net/gh/Fanter2033/ar_mic@main/public/media/bod/bod_ENG.webm"
          loop
          playsinline
          preload="none"
          crossorigin="anonymous"
          webkit-playsinline
        ></video>
      </a-assets>
      <a-marker
        type="pattern"
        url="https://cdn.jsdelivr.net/gh/Fanter2033/ar_mic@main/public/media/bod/pattern-bod.patt"
        smooth="true"
        smoothCount="1"
        smoothTolerance="0.001"
      >
        <a-plane
          src="#bod-video-ita"
          width="4"
          height="4"
          position="0 0.01 0"
          rotation="-90 0 0"
          material="transparent: true;"
        ></a-plane>
      </a-marker>

      <!-- LU -->
      <a-assets id="lu">
        <video
          id="lu-video-ita"
          src="https://cdn.jsdelivr.net/gh/Fanter2033/ar_mic@main/public/media/lu/lu_ITA.webm"
          loop
          playsinline
          preload="none"
          crossorigin="anonymous"
          webkit-playsinline
        ></video>
        <video
          id="lu-video-eng"
          src="https://cdn.jsdelivr.net/gh/Fanter2033/ar_mic@main/public/media/lu/lu_ENG.webm"
          loop
          playsinline
          preload="none"
          crossorigin="anonymous"
          webkit-playsinline
        ></video>
      </a-assets>
      <a-marker
        type="pattern"
        url="https://cdn.jsdelivr.net/gh/Fanter2033/ar_mic@main/public/media/lu/pattern-lu.patt"
        smooth="true"
        smoothCount="1"
        smoothTolerance="0.001"
      >
        <a-plane
          src="#lu-video-ita"
          width="4"
          height="4"
          position="0 0.01 0"
          rotation="-90 0 0"
          material="transparent: true;"
        ></a-plane>
      </a-marker>

      <!-- TIGRE -->
      <a-assets id="tigre">
        <video
          id="tigre-video-ita"
          src="https://cdn.jsdelivr.net/gh/Fanter2033/ar_mic@main/public/media/tiger/tigre_ITA.webm"
          loop
          playsinline
          preload="none"
          crossorigin="anonymous"
          webkit-playsinline
        ></video>
        <video
          id="tigre-video-eng"
          src="https://cdn.jsdelivr.net/gh/Fanter2033/ar_mic@main/public/media/tiger/tigre_ENG.webm"
          loop
          playsinline
          preload="none"
          crossorigin="anonymous"
          webkit-playsinline
        ></video>
      </a-assets>
      <a-marker
        type="pattern"
        url="https://cdn.jsdelivr.net/gh/Fanter2033/ar_mic@main/public/media/tiger/pattern-tigre.patt"
        smooth="true"
        smoothCount="1"
        smoothTolerance="0.001"
      >
        <a-plane
          src="#tigre-video-ita"
          width="4"
          height="4"
          position="0 0.01 0"
          rotation="-90 0 0"
          material="transparent: true;"
        ></a-plane>
      </a-marker>

      <!-- ZHO -->
      <a-assets id="zho">
        <video
          id="zho-video-ita"
          src="/media/zho/zho_ITA.webm"
          loop
          playsinline
          preload="none"
          crossorigin="anonymous"
          webkit-playsinline
        ></video>
        <video
          id="zho-video-eng"
          src="/media/zho/zho_ENG.webm"
          loop
          playsinline
          preload="none"
          crossorigin="anonymous"
          webkit-playsinline
        ></video>
      </a-assets>
      <a-marker
        type="pattern"
        url="https://cdn.jsdelivr.net/gh/Fanter2033/ar_mic@main/public/media/zho/pattern-zho.patt"
        smooth="true"
        smoothCount="1"
        smoothTolerance="0.001"
      >
        <a-plane
          src="#zho-video-ita"
          width="4"
          height="4"
          position="0 0.01 0"
          rotation="-90 0 0"
          material="transparent: true;"
        ></a-plane>
      </a-marker>

      <a-entity camera></a-entity>
    </a-scene>

    <div id="controls">
      <button id="open_tutorial" class="wrapper">
        <span>Tutorial</span>
      </button>

      <button id="unmute-btn">
        <span>Attiva Audio</span>
      </button>

      <button id="sub-btn" class="off">
        <span>CC</span>
        <span id="sub-btn-strike" class="strike-through"></span>
      </button>

      <div class="backdrop" id="backdrop">
        <div class="dialog">
          <button id="close">&times;</button>
          <h2>Tutorial</h2>
          <ul id="tutorial_list">
            <li>Alza il volume del telefono e acconsenti all'accesso della webcam.</li>

            <li>Inquadra gli ideogrammi presenti nelle vetrine e rimani fermo.</li>

            <li>Puoi cambiare la lingua tramite il pulsante in alto a sinistra e attivare i sottotitoli tramite il pulsante 'CC'.</li>

            <li>Per una migliore esperienza, accedi al sito tramite il browser Chrome.</li>

            <li>Per gli utenti iOS, il video partirà senza audio. Clicca il tasto "attiva audio" per abilitarlo.</li>
          </ul>
        </div>
      </div>
    </div>

    <div id="subtitle-overlay" class="subtitle-container"></div>
  </body>
</html>